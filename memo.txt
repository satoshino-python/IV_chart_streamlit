äº†è§£ã—ã¾ã—ãŸï¼
ä»¥ä¸‹ã«ã€**VS Code + Streamlit + BigQuery** ã‚’ä½¿ã£ãŸ**ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã‹ã‚‰ Web å…¬é–‹ã¾ã§ã®æ¦‚è¦æ‰‹é †**ã‚’ã‚ã‹ã‚Šã‚„ã™ãã¾ã¨ã‚ã¾ã™ã€‚

---

## âœ… å…¨ä½“ã®é–‹ç™ºæ‰‹é †æ¦‚è¦ï¼ˆStreamlit + BigQueryï¼‰

### ã‚¹ãƒ†ãƒƒãƒ— 1: é–‹ç™ºç’°å¢ƒã®æº–å‚™ï¼ˆVS Codeï¼‰

### ã‚¹ãƒ†ãƒƒãƒ— 2: BigQuery èªè¨¼ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### ã‚¹ãƒ†ãƒƒãƒ— 3: Streamlit ã‚¢ãƒ—ãƒªã®ä½œæˆ

### ã‚¹ãƒ†ãƒƒãƒ— 4: ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ä½œç¢ºèª

### ã‚¹ãƒ†ãƒƒãƒ— 5: å…¬é–‹ï¼ˆStreamlit Cloud or Cloud Runï¼‰

---

## ğŸ”§ ã‚¹ãƒ†ãƒƒãƒ— 1: é–‹ç™ºç’°å¢ƒã®æº–å‚™

### å¿…è¦ãªãƒ„ãƒ¼ãƒ«

* Python 3.8+
* VS Code
* pipï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ï¼‰
* GCP ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆBigQuery ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰

### ä»®æƒ³ç’°å¢ƒã®ä½œæˆï¼ˆæ¨å¥¨ï¼‰
ä»¥ä¸‹ã®ä»®æƒ³ç’°å¢ƒä½œæˆã¯LINUXã§è¡Œã†ï¼ˆå…·ä½“çš„ã«ã¯VSCODEå·¦ä¸‹ã®ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šã§WSLã«æ¥ç¶šã—ãŸçŠ¶æ…‹ã§è¡Œã†ï¼‰

```bash
python3 -m venv .venv
source .venv/bin/activate  
```

### å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install streamlit google-cloud-bigquery pandas plotly
```

---

## ğŸ” ã‚¹ãƒ†ãƒƒãƒ— 2: BigQuery èªè¨¼ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

1. [Google Cloud Console](https://console.cloud.google.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. å¯¾è±¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ
3. ã€ŒIAMã¨ç®¡ç†ã€â†’ã€Œã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€ã‚’é–‹ã
4. æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã€`BigQuery User` ãƒ­ãƒ¼ãƒ«ã‚’ä»˜ä¸
5. èªè¨¼æƒ…å ±ï¼ˆJSONå½¢å¼ï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
6. JSONãƒ•ã‚¡ã‚¤ãƒ«åã‚’ `credentials.json` ã«å¤‰æ›´ï¼ˆä»»æ„ï¼‰

> â€» `.gitignore` ã« `credentials.json` ã‚’è¿½åŠ ã—ã¦GitHubã«å…¬é–‹ã—ãªã„ã‚ˆã†ã«ï¼

---

## ğŸ§‘â€ğŸ’» ã‚¹ãƒ†ãƒƒãƒ— 3: Streamlit ã‚¢ãƒ—ãƒªã®ä½œæˆï¼ˆä¾‹ï¼‰

`app.py`:

```python
import streamlit as st
from google.cloud import bigquery
import pandas as pd
import plotly.express as px

# èªè¨¼æƒ…å ±ã®èª­ã¿è¾¼ã¿
client = bigquery.Client.from_service_account_json("credentials.json")

# ãƒ‡ãƒ¼ã‚¿å–å¾—
query = """
    SELECT Datetime, future_price, ATM
    FROM `python-op-373206.JPX_web_data.Key_IV_Points`
    ORDER BY Datetime DESC
    LIMIT 400
"""
df = client.query(query).to_dataframe()
df = df.dropna(subset=['ATM'])

# ã‚°ãƒ©ãƒ•æç”»
st.title("ATM IV Chart")
fig = px.line(df.sort_values('Datetime'), x='Datetime', y='ATM', title='ATM IV Over Time')
st.plotly_chart(fig)
```

---

## ğŸš€ ã‚¹ãƒ†ãƒƒãƒ— 4: ãƒ­ãƒ¼ã‚«ãƒ«ã§Streamlitã‚’èµ·å‹•

```bash
streamlit run app.py
```

â†’ `http://localhost:8501` ãŒè‡ªå‹•ã§ãƒ–ãƒ©ã‚¦ã‚¶ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

---

## ğŸŒ ã‚¹ãƒ†ãƒƒãƒ— 5: Webã«å…¬é–‹ï¼ˆ2é€šã‚Šï¼‰

### âœ… æ–¹æ³• A: Streamlit Cloudï¼ˆç°¡å˜ï¼‰

1. [Streamlit Cloud](https://streamlit.io/cloud) ã«ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆGitHubé€£æºï¼‰
2. GitHub ã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ push
3. ã€ŒNew appã€ã§ãƒªãƒã‚¸ãƒˆãƒªã‚’é¸æŠ
4. **ç’°å¢ƒå¤‰æ•°ã« BigQuery èªè¨¼ã‚’è¨­å®šã™ã‚‹å¿…è¦ã‚ã‚Šï¼ˆã‚„ã‚„è¤‡é›‘ï¼‰**

ğŸ” æ³¨æ„ï¼š`credentials.json` ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ããªã„ãŸã‚ã€ç’°å¢ƒå¤‰æ•°ã‚„ secrets ç®¡ç†ãŒå¿…è¦ã§ã™

---

### âœ… æ–¹æ³• B: Google Cloud Runï¼ˆæœ¬æ ¼çš„ï¼‰

1. Dockerfile ã‚’ä½œæˆ
2. Google Cloud SDK ã§ Cloud Run ã«ãƒ‡ãƒ—ãƒ­ã‚¤
3. `credentials.json` ã¯ç’°å¢ƒå¤‰æ•°ã§èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ã™ã‚‹
4. å…¬é–‹URLãŒç™ºè¡Œã•ã‚Œã‚‹ï¼ˆä¾‹ï¼š`https://atm-iv-viewer.a.run.app`ï¼‰

---

## ğŸ—‚ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆä¾‹

```
my-streamlit-app/
â”œâ”€â”€ app.py
â”œâ”€â”€ credentials.json  â† .gitignoreã«è¿½åŠ ï¼
â”œâ”€â”€ requirements.txt
â””â”€â”€ .gitignore
```

### `requirements.txt`

```text
streamlit
pandas
plotly
google-cloud-bigquery
```

### `.gitignore`

```
credentials.json
__pycache__/
venv/
```

---

## âœ‹ å¿…è¦ãªã‚‰æ¬¡ã‚‚ã‚µãƒãƒ¼ãƒˆã§ãã¾ã™

* `requirements.txt` / `Dockerfile` ä½œæˆ
* Streamlit Cloud ã§ã® BigQuery èªè¨¼ã®è¨­å®šæ–¹æ³•
* Google Cloud Run ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
* ãƒ­ã‚°ã‚¤ãƒ³ä¸è¦ã§è¦‹ã›ã‚‰ã‚Œã‚‹URLã®å…¬é–‹æ–¹æ³•

---

ã”å¸Œæœ›ã®å…¬é–‹æ–¹æ³•ï¼ˆStreamlit Cloud ã‹ Google Cloud Runï¼‰ã‚’æ•™ãˆã¦ã„ãŸã ã‘ã‚Œã°ã€æ¬¡ã®æ‰‹é †ã‚’ã”æ¡ˆå†…ã—ã¾ã™ï¼
